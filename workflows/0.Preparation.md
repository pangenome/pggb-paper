# Preparation


Variables:

```shell
DIR_REPOSITORY=/lizardfs/guarracino/pggb-paper
```

## Data compression

```shell
cd $DIR_REPOSITORY/assemblies

ls *fa | while read FASTA; do
    echo $FASTA
    zstd -12 $FASTA
done

# "zstd -d file.zst" to decompress
```

## Tools

```shell
mkdir -p ~/tools $$ cd ~/tools

git clone --recursive https://github.com/waveygang/wfmash
cd wfmash
git checkout master && git pull && git submodule update --init --recursive
git checkout 191afe12042962d3c0d5c62936528561753b3da0
cmake -H. -Bbuild && cmake --build build -- -j 48
cp build/bin/wfmash build/bin/wfmash-191afe12042962d3c0d5c62936528561753b3da0
cd ..

git clone --recursive https://github.com/ekg/seqwish.git
cd seqwish
git checkout master && git pull && git submodule update --init --recursive
git checkout d9e7ab59e73258f57875f2a060437735a460475e
rm -rf build/
cmake -H. -Bbuild && cmake --build build -- -j 48
cp bin/seqwish bin/seqwish-d9e7ab59e73258f57875f2a060437735a460475e
cd ..

git clone --recursive https://github.com/pangenome/smoothxg.git
cd smoothxg
git checkout master && git pull && git submodule update --init --recursive
git checkout 06bbf3510b095f1f2cb94f580845bfd5097f3047
rm -rf build/
cmake -H. -Bbuild && cmake --build build -- -j 48
cp bin/smoothxg bin/smoothxg-06bbf3510b095f1f2cb94f580845bfd5097f3047
cd ..

git clone --recursive https://github.com/pangenome/odgi.git
cd odgi
git checkout master && git pull && git submodule update --init --recursive
git checkout bfae0b3c70a0f044d7ce8510b7a45f59d5138626
rm -rf build/
cmake -H. -Bbuild && cmake --build build -- -j 48
cp bin/odgi bin/odgi-bfae0b3c70a0f044d7ce8510b7a45f59d5138626
cd ..

git clone --recursive https://github.com/pangenome/pggb.git
cd pggb
git checkout master && git pull && git submodule update --init --recursive
git checkout b3c55023313c28d89281d2e0ca0f10d25685d4e7
cp pggb pggb-x
sed 's,"$fmt" wfmash,"$fmt" ~/tools/wfmash/build/bin/wfmash-191afe12042962d3c0d5c62936528561753b3da0,g' pggb-x -i
sed 's,$(wfmash,$(~/tools/wfmash/build/bin/wfmash-191afe12042962d3c0d5c62936528561753b3da0,g' pggb-x -i
sed 's,"$fmt" seqwish,"$fmt" ~/tools/seqwish/bin/seqwish-f362f6f5ea89dbb6a0072a8b8ba215e663301d33,g' pggb-x -i
sed 's,"$fmt" smoothxg,"$fmt" ~/tools/smoothxg/bin/smoothxg-e4c1149141ceb896740a8831a5e35fa65b7ba238,g' pggb-x -i
sed 's,"$fmt" odgi,"$fmt" ~/tools/odgi/bin/odgi-bfae0b3c70a0f044d7ce8510b7a45f59d5138626,g' pggb -i
mv pggb-x pggb-b3c55023313c28d89281d2e0ca0f10d25685d4e7
cd ..

wget -c https://github.com/vgteam/vg/releases/download/v1.40.0/vg
chmod +x vg

git clone --recursice https://github.com/pangenome/vcfbub.git
cd vcfbub
git checkout d92ae50da4926612f9bcf5d3ea8506a78a348734 # version 0.1.0
cargo build --release

/gnu/store/hkbkw85gjvsyqvx9vv9bw0ynmad989ag-vcflib-1.0.3+a36dbe9-11/bin/vcfwave


# MashMap3-based PGGB
mkdir forks && cd forks
git clone --recursive https://github.com/bkille/wfmash
cd wfmash
git checkout minmer-nominimizer && git pull && git submodule update --init --recursive
git checkout edbb5c3b678a0e379181f34295fd5a40bed95a17
cmake -H. -Bbuild && cmake --build build -- -j 48
mv build/bin/wfmash build/bin/wfmash-edbb5c3b678a0e379181f34295fd5a40bed95a17-mm3
cd ../..

cd pggb
git checkout master && git pull && git submodule update --init --recursive
git checkout b3c55023313c28d89281d2e0ca0f10d25685d4e7
cp pggb pggb-x
sed 's,"$fmt" wfmash,"$fmt" ~/tools/forks/wfmash/build/bin/wfmash-edbb5c3b678a0e379181f34295fd5a40bed95a17-mm3,g' pggb-x -i
sed 's,$(wfmash,$(~/tools/forks/wfmash/build/bin/wfmash-edbb5c3b678a0e379181f34295fd5a40bed95a17-mm3,g' pggb-x -i
sed 's,"$fmt" seqwish,"$fmt" ~/tools/seqwish/bin/seqwish-f362f6f5ea89dbb6a0072a8b8ba215e663301d33,g' pggb-x -i
sed 's,"$fmt" smoothxg,"$fmt" ~/tools/smoothxg/bin/smoothxg-e4c1149141ceb896740a8831a5e35fa65b7ba238,g' pggb-x -i
sed 's,"$fmt" odgi,"$fmt" ~/tools/odgi/bin/odgi-bfae0b3c70a0f044d7ce8510b7a45f59d5138626,g' pggb -i
mv pggb-x pggb-b3c55023313c28d89281d2e0ca0f10d25685d4e7-mm3
cd ..
```


## Data

```shell
mkdir -p $DIR_REPOSITORY/assemblies/sars_cov_2
cd $DIR_REPOSITORY/assemblies/sars_cov_2

cp $DIR_REPOSITORY/data/accession_numbers.SARS-CoV-2.txt .
cp $DIR_REPOSITORY/data/download_SARS-CoV-2.sh .
```
